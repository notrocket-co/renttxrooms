<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Texas Rooms Hub - Quality Housing Solutions</title>
    <meta name="description" content="Quality room rentals across Texas">
    <link rel="stylesheet" href="styles.css?v=2025-09-03-1">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo">Texas Rooms Hub</h1>
                <p class="tagline">Your Gateway to Quality Housing</p>
            </div>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <section class="intro-section">
                <h2>Looking for a Room to Rent in Texas?</h2>
                <p class="intro-text">
                    We connect quality tenants with available rooms across the great state of Texas. 
                    Fill out the quick form below to get started on finding your new home.
                </p>
            </section>

            <section class="form-section">
                <div class="form-container">
                    <div class="form-header">
                        <h3>Texas Housing Interest Form</h3>
                        <p>Please fill out all fields to help us match you with the perfect room.</p>
                    </div>
                    <div class="form-wrapper">
                        <form id="roomForm" class="custom-form">
                            <!-- Loading State -->
                            <div id="formLoading" class="form-loading" style="display: none;">
                                <div class="loading-spinner"></div>
                                <p>Submitting your application...</p>
                            </div>

                            <!-- Success State -->
                            <div id="formSuccess" class="form-success" style="display: none;">
                                <div class="success-icon">âœ“</div>
                                <h3>Thank You!</h3>
                                <p>We'll reach out if we have something available that fits your needs!</p>
                            </div>

                            <!-- Form Fields -->
                            <div id="formFields" class="form-fields">
                                <!-- Areas of Interest -->
                                <div class="form-group">
                                    <label class="form-label required">Which areas are you most interested in? (select all that apply)</label>
                                    <div class="checkbox-group">
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="areas" value="Houston">
                                            <span class="checkbox-custom"></span>
                                            Houston
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="areas" value="Dallas">
                                            <span class="checkbox-custom"></span>
                                            Dallas
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="areas" value="Fort Worth">
                                            <span class="checkbox-custom"></span>
                                            Fort Worth
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="areas" value="San Antonio">
                                            <span class="checkbox-custom"></span>
                                            San Antonio
                                        </label>
                                    </div>
                                    <div class="error-message" id="areasError"></div>
                                </div>

                                <!-- Full Name -->
                                <div class="form-group">
                                    <label for="fullName" class="form-label required">Full Name</label>
                                    <input type="text" id="fullName" name="fullName" class="form-input" required>
                                    <div class="error-message" id="fullNameError"></div>
                                </div>

                                <!-- Email -->
                                <div class="form-group">
                                    <label for="email" class="form-label required">Email</label>
                                    <input type="email" id="email" name="email" class="form-input" required>
                                    <div class="error-message" id="emailError"></div>
                                </div>

                                <!-- Phone -->
                                <div class="form-group">
                                    <label for="phone" class="form-label required">Phone</label>
                                    <input type="tel" id="phone" name="phone" class="form-input" required pattern="[0-9\-\(\)\s\+\.]{10,}">
                                    <div class="error-message" id="phoneError"></div>
                                </div>

                                <!-- Where did you find this listing -->
                                <div class="form-group">
                                    <label for="foundListing" class="form-label required">Where did you find this listing?</label>
                                    <select id="foundListing" name="foundListing" class="form-input" required>
                                        <option value="" disabled selected>Select an option</option>
                                        <option>Facebook Marketplace</option>
                                        <option>Roomies</option>
                                        <option>Zillow</option>
                                    </select>
                                    <div class="error-message" id="foundListingError"></div>
                                </div>

                                <!-- Pets -->
                                <div class="form-group">
                                    <label class="form-label required">Do you have pets?</label>
                                    <div class="radio-group">
                                        <label class="radio-item">
                                            <input type="radio" name="pets" value="Yes" required>
                                            <span class="radio-custom"></span>
                                            Yes
                                        </label>
                                        <label class="radio-item">
                                            <input type="radio" name="pets" value="No" required>
                                            <span class="radio-custom"></span>
                                            No
                                        </label>
                                    </div>
                                    <div class="error-message" id="petsError"></div>
                                </div>

                                <!-- Credit Score -->
                                <div class="form-group">
                                    <label for="creditScore" class="form-label required">What is your credit score?</label>
                                    <input type="number" id="creditScore" name="creditScore" class="form-input" required min="300" max="850" placeholder="300-850 (enter 850 if no credit)">
                                    <div class="form-hint">Please enter a number (300-850). If you don't have credit, enter 850.</div>
                                    <div class="error-message" id="creditScoreError"></div>
                                </div>

                                <!-- Annual Income -->
                                <div class="form-group">
                                    <label for="annualIncome" class="form-label required">What is your combined ANNUAL income before taxes?</label>
                                    <input type="number" id="annualIncome" name="annualIncome" class="form-input" required min="1" placeholder="e.g., 50000">
                                    <div class="error-message" id="annualIncomeError"></div>
                                </div>

                                <!-- Months Planning to Live -->
                                <div class="form-group">
                                    <label for="monthsPlanned" class="form-label required">How many MONTHS would you plan on living in this home?</label>
                                    <input type="number" id="monthsPlanned" name="monthsPlanned" class="form-input" required min="0" placeholder="e.g., 12">
                                    <div class="error-message" id="monthsPlannedError"></div>
                                </div>

                                <!-- Number of People -->
                                <div class="form-group">
                                    <label for="numPeople" class="form-label required">How many people will be living in your unit in total?</label>
                                    <input type="number" id="numPeople" name="numPeople" class="form-input" required min="1" placeholder="e.g., 1">
                                    <div class="error-message" id="numPeopleError"></div>
                                </div>

                                <!-- Felonies -->
                                <div class="form-group">
                                    <label for="felonies" class="form-label required">How many felonies do you have?</label>
                                    <input type="number" id="felonies" name="felonies" class="form-input" required min="0" placeholder="e.g., 0">
                                    <div class="error-message" id="feloniesError"></div>
                                </div>

                                <!-- Evictions -->
                                <div class="form-group">
                                    <label for="evictions" class="form-label required">How many evictions have been filed upon you?</label>
                                    <input type="number" id="evictions" name="evictions" class="form-input" required min="0" placeholder="e.g., 0">
                                    <div class="error-message" id="evictionsError"></div>
                                </div>

                                <!-- Smoking -->
                                <div class="form-group">
                                    <label class="form-label required">Do you smoke cigarettes?</label>
                                    <div class="radio-group">
                                        <label class="radio-item">
                                            <input type="radio" name="smoking" value="Yes" required>
                                            <span class="radio-custom"></span>
                                            Yes
                                        </label>
                                        <label class="radio-item">
                                            <input type="radio" name="smoking" value="No" required>
                                            <span class="radio-custom"></span>
                                            No
                                        </label>
                                        <label class="radio-item">
                                            <input type="radio" name="smoking" value="Outside Smoking Only" required>
                                            <span class="radio-custom"></span>
                                            Outside Smoking Only
                                        </label>
                                    </div>
                                    <div class="error-message" id="smokingError"></div>
                                </div>

                                <!-- Furnished -->
                                <div class="form-group">
                                    <label class="form-label required">Would you rather the bedroom be furnished or unfurnished?</label>
                                    <div class="radio-group">
                                        <label class="radio-item">
                                            <input type="radio" name="furnished" value="I have my own bedroom furnishings or will buy them." required>
                                            <span class="radio-custom"></span>
                                            I have my own bedroom furnishings or will buy them.
                                        </label>
                                        <label class="radio-item">
                                            <input type="radio" name="furnished" value="I need bedroom furnishings to be provided for me (bed, dresser, desk)." required>
                                            <span class="radio-custom"></span>
                                            I need bedroom furnishings to be provided for me (bed, dresser, desk).
                                        </label>
                                    </div>
                                    <div class="error-message" id="furnishedError"></div>
                                </div>

                                <!-- Move-in Date -->
                                <div class="form-group">
                                    <label for="moveInDate" class="form-label required">When would you like to move in?</label>
                                    <input type="date" id="moveInDate" name="moveInDate" class="form-input" required>
                                    <div class="error-message" id="moveInDateError"></div>
                                </div>

                                <!-- Disclaimer -->
                                <div class="form-group">
                                    <p class="form-disclaimer">
                                        Your information may be shared with qualified housing partners if we don't have an available room. In some instances, we may receive a referral fee from these partners if you choose to rent with them. We never sell your personal information to unrelated third parties.
                                    </p>
                                </div>

                                <!-- Submit Button -->
                                <div class="form-submit">
                                    <button type="submit" class="submit-btn">
                                        <span class="submit-text">Submit</span>
                                        <div class="submit-spinner" style="display: none;"></div>
                                    </button>
                                    <p class="required-note">* Required fields</p>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>Linking residents with premium housing solutions.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('roomForm');
            
            // Only proceed if the form exists (i.e., we're using the custom form)
            if (!form) return;
            
            const formFields = document.getElementById('formFields');
            const formLoading = document.getElementById('formLoading');
            const formSuccess = document.getElementById('formSuccess');
            const submitBtn = form.querySelector('.submit-btn');
            const submitText = submitBtn.querySelector('.submit-text');
            const submitSpinner = submitBtn.querySelector('.submit-spinner');

            // Hide other area input initially
            // Note: Other area functionality removed as requested

            // Add touched class to inputs when user interacts with them
            const formInputs = form.querySelectorAll('.form-input, select');
            formInputs.forEach(input => {
                input.addEventListener('blur', function() {
                    if (this.value.length > 0 || this.hasAttribute('data-touched')) {
                        this.classList.add('touched');
                        this.setAttribute('data-touched', 'true');
                    }
                });
                
                input.addEventListener('input', function() {
                    this.setAttribute('data-touched', 'true');
                });
                
                input.addEventListener('change', function() {
                    this.setAttribute('data-touched', 'true');
                });
            });

            // Form validation functions
            function validateField(field, errorId, customMessage = null) {
                const errorElement = document.getElementById(errorId);
                let isValid = true;
                let message = '';

                if (field.type === 'email') {
                    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailPattern.test(field.value)) {
                        isValid = false;
                        message = 'Please enter a valid email address.';
                    }
                } else if (field.type === 'tel') {
                    const phonePattern = /^[\d\s\-\(\)\+\.]{10,}$/;
                    if (!phonePattern.test(field.value)) {
                        isValid = false;
                        message = 'Please enter a valid phone number.';
                    }
                } else if (field.type === 'number') {
                    const num = parseFloat(field.value);
                    if (isNaN(num) || num < parseFloat(field.min) || num > parseFloat(field.max)) {
                        isValid = false;
                        message = customMessage || `Please enter a number between ${field.min} and ${field.max}.`;
                    }
                } else if (field.required && !field.value.trim()) {
                    isValid = false;
                    message = 'This field is required.';
                }

                if (customMessage && !isValid) {
                    message = customMessage;
                }

                if (errorElement) {
                    errorElement.textContent = message;
                    errorElement.style.display = message ? 'block' : 'none';
                }

                return isValid;
            }

            function validateCheckboxGroup(name, errorId) {
                const checkboxes = form.querySelectorAll(`input[name="${name}"]`);
                const checked = Array.from(checkboxes).some(cb => cb.checked);
                const errorElement = document.getElementById(errorId);

                if (!checked) {
                    if (errorElement) {
                        errorElement.textContent = 'Please select at least one option.';
                        errorElement.style.display = 'block';
                    }
                    return false;
                }

                if (errorElement) {
                    errorElement.style.display = 'none';
                }
                return true;
            }

            function validateRadioGroup(name, errorId) {
                const radios = form.querySelectorAll(`input[name="${name}"]`);
                const checked = Array.from(radios).some(radio => radio.checked);
                const errorElement = document.getElementById(errorId);

                if (!checked) {
                    if (errorElement) {
                        errorElement.textContent = 'Please select an option.';
                        errorElement.style.display = 'block';
                    }
                    return false;
                }

                if (errorElement) {
                    errorElement.style.display = 'none';
                }
                return true;
            }

            // Real-time validation
            form.addEventListener('input', function(e) {
                if (e.target.classList.contains('form-input')) {
                    const fieldId = e.target.id;
                    const errorId = fieldId + 'Error';
                    
                    if (fieldId === 'creditScore') {
                        validateField(e.target, errorId, 'Please enter a number between 300-850. If you don\'t have credit, enter 850.');
                    } else {
                        validateField(e.target, errorId);
                    }
                }
            });

            form.addEventListener('change', function(e) {
                if (e.target.type === 'checkbox') {
                    if (e.target.name === 'areas') {
                        validateCheckboxGroup('areas', 'areasError');
                    }
                } else if (e.target.type === 'radio') {
                    validateRadioGroup(e.target.name, e.target.name + 'Error');
                } else if (e.target.tagName === 'SELECT') {
                    const fieldId = e.target.id;
                    const errorId = fieldId + 'Error';
                    validateField(e.target, errorId);
                }
            });

            form.addEventListener('submit', async function(e) {
                e.preventDefault();

                // Validate all fields
                let isFormValid = true;

                // Validate areas
                if (!validateCheckboxGroup('areas', 'areasError')) {
                    isFormValid = false;
                }

                // Validate text inputs
                const textInputs = ['fullName', 'email', 'phone', 'foundListing', 'creditScore', 'annualIncome', 'monthsPlanned', 'numPeople', 'felonies', 'evictions', 'moveInDate'];
                textInputs.forEach(inputId => {
                    const field = document.getElementById(inputId);
                    if (field) {
                        const errorId = inputId + 'Error';
                        let customMessage = null;
                        
                        if (inputId === 'creditScore') {
                            customMessage = 'Please enter a number between 300-850. If you don\'t have credit, enter 850.';
                        }
                        
                        if (!validateField(field, errorId, customMessage)) {
                            isFormValid = false;
                        }
                    }
                });

                // Validate radio groups
                const radioGroups = ['pets', 'smoking', 'furnished'];
                radioGroups.forEach(groupName => {
                    if (!validateRadioGroup(groupName, groupName + 'Error')) {
                        isFormValid = false;
                    }
                });

                if (!isFormValid) {
                    // Scroll to first error
                    const firstError = form.querySelector('.error-message[style*="block"]');
                    if (firstError) {
                        firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                    return;
                }

                // Show loading state
                formFields.style.display = 'none';
                formLoading.style.display = 'block';

                // Collect form data
                const formData = new FormData();
                const areas = Array.from(form.querySelectorAll('input[name="areas"]:checked')).map(cb => cb.value);
                
                const data = {
                    areas: areas,
                    fullName: form.fullName.value,
                    email: form.email.value,
                    phone: form.phone.value,
                    foundListing: form.foundListing.value,
                    creditScore: form.creditScore.value,
                    annualIncome: form.annualIncome.value,
                    monthsPlanned: form.monthsPlanned.value,
                    numPeople: form.numPeople.value,
                    pets: form.pets.value,
                    felonies: form.felonies.value,
                    evictions: form.evictions.value,
                    smoking: form.smoking.value,
                    furnished: form.furnished.value,
                    moveInDate: form.moveInDate.value
                };

                try {
                    console.log('Submitting form data:', data);

                    // Submit using no-cors so the browser doesn't block the response
                    const fd = new FormData();
                    fd.append('data', JSON.stringify(data));

                    await fetch('https://script.google.com/macros/s/AKfycbwl8AT9W6BOCcl_JkP21rrX6BZRj3rPTWUsKH2rRnag676PshpVE6W1fbd5fJa5nukK/exec', {
                        method: 'POST',
                        body: fd,
                        mode: 'no-cors'
                    });

                    // We cannot read the response in no-cors mode, but the request was sent.
                    // Show success state optimistically (submission already reaches the Sheet).
                    formFields.style.display = 'none';
                    formLoading.style.display = 'none';
                    formSuccess.style.display = 'block';

                } catch (error) {
                    console.error('Submission error:', error);
                    
                    // Show error and allow retry
                    formLoading.style.display = 'none';
                    formFields.style.display = 'block';
                    
                    alert('There was an error submitting your form. Please try again.');
                }
            });

            // Smooth scrolling for anchor links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
        });
    </script>
</body>
</html>
